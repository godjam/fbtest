var t={},e=[],n=[];function o(o,r){var i,s,a,l,u=n;for(l=arguments.length;l-- >2;)e.push(arguments[l]);for(r&&null!=r.children&&(e.length||e.push(r.children),delete r.children);e.length;)if((s=e.pop())&&void 0!==s.pop)for(l=s.length;l--;)e.push(s[l]);else"boolean"==typeof s&&(s=null),(a="function"!=typeof o)&&(null==s?s="":"number"==typeof s?s=String(s):"string"!=typeof s&&(a=!1)),a&&i?u[u.length-1]+=s:u===n?u=[s]:u.push(s),i=a;var c=new function(){};return c.nodeName=o,c.children=u,c.attributes=null==r?void 0:r,c.key=null==r?void 0:r.key,void 0!==t.vnode&&t.vnode(c),c}function r(t,e){for(var n in e)t[n]=e[n];return t}var i="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,s=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,a=[];function l(e){!e._dirty&&(e._dirty=!0)&&1==a.push(e)&&(t.debounceRendering||i)(u)}function u(){var t,e=a;for(a=[];t=e.pop();)t._dirty&&U(t)}function c(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function p(t){var e=r({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var o in n)void 0===e[o]&&(e[o]=n[o]);return e}function h(t){var e=t.parentNode;e&&e.removeChild(t)}function d(t,e,n,o,r){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)n&&n(null),o&&o(t);else if("class"!==e||r)if("style"===e){if(o&&"string"!=typeof o&&"string"!=typeof n||(t.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var i in n)i in o||(t.style[i]="");for(var i in o)t.style[i]="number"==typeof o[i]&&!1===s.test(i)?o[i]+"px":o[i]}}else if("dangerouslySetInnerHTML"===e)o&&(t.innerHTML=o.__html||"");else if("o"==e[0]&&"n"==e[1]){var a=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),o?n||t.addEventListener(e,f,a):t.removeEventListener(e,f,a),(t._listeners||(t._listeners={}))[e]=o}else if("list"!==e&&"type"!==e&&!r&&e in t)!function(t,e,n){try{t[e]=n}catch(t){}}(t,e,null==o?"":o),null!=o&&!1!==o||t.removeAttribute(e);else{var l=r&&e!==(e=e.replace(/^xlink\:?/,""));null==o||!1===o?l?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof o&&(l?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),o):t.setAttribute(e,o))}else t.className=o||""}function f(e){return this._listeners[e.type](t.event&&t.event(e)||e)}var v=[],m=0,_=!1,y=!1;function b(){for(var e;e=v.pop();)t.afterMount&&t.afterMount(e),e.componentDidMount&&e.componentDidMount()}function x(t,e,n,o,r,i){m++||(_=null!=r&&void 0!==r.ownerSVGElement,y=null!=t&&!("__preactattr_"in t));var s=C(t,e,n,o,i);return r&&s.parentNode!==r&&r.appendChild(s),--m||(y=!1,i||b()),s}function C(t,e,n,o,r){var i=t,s=_;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||r)?t.nodeValue!=e&&(t.nodeValue=e):(i=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(i,t),g(t,!0))),i.__preactattr_=!0,i;var a,l,u=e.nodeName;if("function"==typeof u)return function(t,e,n,o){var r=t&&t._component,i=r,s=t,a=r&&t._componentConstructor===e.nodeName,l=a,u=p(e);for(;r&&!l&&(r=r._parentComponent);)l=r.constructor===e.nodeName;r&&l&&(!o||r._component)?(P(r,u,3,n,o),t=r.base):(i&&!a&&(L(i),t=s=null),r=S(e.nodeName,u,n),t&&!r.nextBase&&(r.nextBase=t,s=null),P(r,u,1,n,o),t=r.base,s&&t!==s&&(s._component=null,g(s,!1)));return t}(t,e,n,o);if(_="svg"===u||"foreignObject"!==u&&_,u=String(u),(!t||!c(t,u))&&(a=u,(l=_?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a)).normalizedNodeName=a,i=l,t)){for(;t.firstChild;)i.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(i,t),g(t,!0)}var f=i.firstChild,v=i.__preactattr_,m=e.children;if(null==v){v=i.__preactattr_={};for(var b=i.attributes,x=b.length;x--;)v[b[x].name]=b[x].value}return!y&&m&&1===m.length&&"string"==typeof m[0]&&null!=f&&void 0!==f.splitText&&null==f.nextSibling?f.nodeValue!=m[0]&&(f.nodeValue=m[0]):(m&&m.length||null!=f)&&function(t,e,n,o,r){var i,s,a,l,u,p=t.childNodes,d=[],f={},v=0,m=0,_=p.length,y=0,b=e?e.length:0;if(0!==_)for(var x=0;x<_;x++){var k=p[x],w=k.__preactattr_,S=b&&w?k._component?k._component.__key:w.key:null;null!=S?(v++,f[S]=k):(w||(void 0!==k.splitText?!r||k.nodeValue.trim():r))&&(d[y++]=k)}if(0!==b)for(var x=0;x<b;x++){u=null;var S=(l=e[x]).key;if(null!=S)v&&void 0!==f[S]&&(u=f[S],f[S]=void 0,v--);else if(!u&&m<y)for(i=m;i<y;i++)if(void 0!==d[i]&&(N=s=d[i],U=r,"string"==typeof(P=l)||"number"==typeof P?void 0!==N.splitText:"string"==typeof P.nodeName?!N._componentConstructor&&c(N,P.nodeName):U||N._componentConstructor===P.nodeName)){u=s,d[i]=void 0,i===y-1&&y--,i===m&&m++;break}u=C(u,l,n,o),a=p[x],u&&u!==t&&u!==a&&(null==a?t.appendChild(u):u===a.nextSibling?h(a):t.insertBefore(u,a))}var N,P,U;if(v)for(var x in f)void 0!==f[x]&&g(f[x],!1);for(;m<=y;)void 0!==(u=d[y--])&&g(u,!1)}(i,m,n,o,y||null!=v.dangerouslySetInnerHTML),function(t,e,n){var o;for(o in n)e&&null!=e[o]||null==n[o]||d(t,o,n[o],n[o]=void 0,_);for(o in e)"children"===o||"innerHTML"===o||o in n&&e[o]===("value"===o||"checked"===o?t[o]:n[o])||d(t,o,n[o],n[o]=e[o],_)}(i,e.attributes,v),_=s,i}function g(t,e){var n=t._component;n?L(n):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||h(t),k(t))}function k(t){for(t=t.lastChild;t;){var e=t.previousSibling;g(t,!0),t=e}}var w={};function S(t,e,n){var o,r=w[t.name];if(t.prototype&&t.prototype.render?(o=new t(e,n),I.call(o,e,n)):((o=new I(e,n)).constructor=t,o.render=N),r)for(var i=r.length;i--;)if(r[i].constructor===t){o.nextBase=r[i].nextBase,r.splice(i,1);break}return o}function N(t,e,n){return this.constructor(t,n)}function P(e,n,o,r,i){e._disable||(e._disable=!0,(e.__ref=n.ref)&&delete n.ref,(e.__key=n.key)&&delete n.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=n,e._disable=!1,0!==o&&(1!==o&&!1===t.syncComponentUpdates&&e.base?l(e):U(e,1,i)),e.__ref&&e.__ref(e))}function U(e,n,o,i){if(!e._disable){var s,a,l,u=e.props,c=e.state,h=e.context,d=e.prevProps||u,f=e.prevState||c,_=e.prevContext||h,y=e.base,C=e.nextBase,k=y||C,w=e._component,N=!1;if(y&&(e.props=d,e.state=f,e.context=_,2!==n&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(u,c,h)?N=!0:e.componentWillUpdate&&e.componentWillUpdate(u,c,h),e.props=u,e.state=c,e.context=h),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!N){s=e.render(u,c,h),e.getChildContext&&(h=r(r({},h),e.getChildContext()));var I,M,B=s&&s.nodeName;if("function"==typeof B){var T=p(s);(a=w)&&a.constructor===B&&T.key==a.__key?P(a,T,1,h,!1):(I=a,e._component=a=S(B,T,h),a.nextBase=a.nextBase||C,a._parentComponent=e,P(a,T,0,h,!1),U(a,1,o,!0)),M=a.base}else l=k,(I=w)&&(l=e._component=null),(k||1===n)&&(l&&(l._component=null),M=x(l,s,h,o||!y,k&&k.parentNode,!0));if(k&&M!==k&&a!==w){var D=k.parentNode;D&&M!==D&&(D.replaceChild(M,k),I||(k._component=null,g(k,!1)))}if(I&&L(I),e.base=M,M&&!i){for(var j=e,E=e;E=E._parentComponent;)(j=E).base=M;M._component=j,M._componentConstructor=j.constructor}}if(!y||o?v.unshift(e):N||(e.componentDidUpdate&&e.componentDidUpdate(d,f,_),t.afterUpdate&&t.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);m||i||b()}}function L(e){t.beforeUnmount&&t.beforeUnmount(e);var n=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var o=e._component;o?L(o):n&&(n.__preactattr_&&n.__preactattr_.ref&&n.__preactattr_.ref(null),e.nextBase=n,h(n),function(t){var e=t.constructor.name;(w[e]||(w[e]=[])).push(t)}(e),k(n)),e.__ref&&e.__ref(null)}function I(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{}}r(I.prototype,{setState:function(t,e){var n=this.state;this.prevState||(this.prevState=r({},n)),r(n,"function"==typeof t?t(n,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),l(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),U(this,2)},render:function(){}});var M=function(t){function e(){t.call(this),this.state={places:3,prixmin:100,prixmax:300}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.sendInit=function(){return new Promise(function(t,e){return this.props.wioService.init(this.state.places,this.state.prixmin,this.state.prixmax).then(function(n){try{return this.props.next(),t()}catch(t){return e(t)}}.bind(this),e)}.bind(this))},e.prototype.handleChange=function(t,e){var n;this.setState(((n={})[t]=e.target.value,n))},e.prototype.render=function(){var t=this;return o("div",null,o("div",null," Places : ",o("select",{value:this.state.places,onChange:function(e){return t.handleChange("places",e)}},o("option",{value:"2"}," 2 "),o("option",{value:"3"}," 3 "),o("option",{value:"4"}," 4 "),o("option",{value:"5"}," 5 "))),o("div",null," Prix min : ",o("select",{value:this.state.prixmin,onChange:function(e){return t.handleChange("prixmin",e)}},o("option",{value:"100"}," 100 € "),o("option",{value:"200"}," 200 € "),o("option",{value:"300"}," 300 € "),o("option",{value:"400"}," 400 € "))),o("div",null," Prix max : ",o("select",{value:this.state.prixmax,onChange:function(e){return t.handleChange("prixmax",e)}},o("option",{value:"200"}," 200 € "),o("option",{value:"300"}," 300 € "),o("option",{value:"400"}," 400 € "),o("option",{value:"500"}," 500 € "))),o("button",{onClick:function(){return t.sendInit()}},"Valider"))},e}(I),B=function(t){function e(){t.call(this),this.state={next:null}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.componentDidMount=function(){this.setState({next:this.props.wioService.lastSku})},e.prototype.handleClick=function(t){return new Promise(function(e,n){var o;return this.props.wioService.next(this.state.next.sku,t).then(function(t){try{if(o=t,console.log(o),!1===o.should_continue)this.props.next();else this.setState({next:o.next||{sku:"aspenblgr",score:1}});return e()}catch(t){return n(t)}}.bind(this),n)}.bind(this))},e.prototype.render=function(){var t=this,e=this.state.next;return e?o("div",null,o("div",null,"SKU: ",e.sku," (",e.score,")"),o("button",{onClick:function(){return t.handleClick(1)}},"Like"),o("button",{onClick:function(){return t.handleClick(-1)}},"Dislike")):o("div",null,"Chargement ...")},e}(I),T=function(t){function e(){t.call(this),this.state={similarSkus:null}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.componentDidMount=function(){return new Promise(function(t,e){return this.props.wioService.last().then(function(n){try{return this.setState({similarSkus:n.couchSkuList}),t()}catch(t){return e(t)}}.bind(this),e)}.bind(this))},e.prototype.render=function(){var t=this.state.similarSkus;return t?o("div",null,o("h3",null,"Fin"),o("p",null,"Liste des canapés similaires :"),o("ul",null,t.map(function(t){return o("li",{key:t.sku},t.sku," (",t.score,")")}))):o("div",null,"Chargement ...")},e}(I),D={PROD:"https://prod.winitout.com/api/",LOCAL:"http://localhost:8080/api/",CIBLER:"https://qa.winitout.com/api/"},j=function(t){this.baseUrl=D[t]||D.PROD,this.sessionId=~~(2e3*Math.random()),this.lastSku=null};j.prototype.init=function(t,e,n){return void 0===t&&(t=3),void 0===e&&(e=100),void 0===n&&(n=500),new Promise(function(o,r){var i,s;return i=this.baseUrl+"couch_sku/init/000/?sessionId="+this.sessionId+"&places="+t+"&pricemin="+e+"&pricemax="+n,console.log(i),fetch(i).then(function(t){try{return t.json().then(function(t){try{return this.lastSku=s=t,o(s)}catch(t){return r(t)}}.bind(this),r)}catch(t){return r(t)}}.bind(this),r)}.bind(this))},j.prototype.next=function(t,e){return new Promise(function(n,o){var r,i;return r=this.baseUrl+"couch_sku/next/000/?sessionId="+this.sessionId+"&sku="+t+"&likes="+e,console.log(r),fetch(r).then(function(t){try{return t.json().then(function(t){try{return this.lastSku=(i=t).next,n(i)}catch(t){return o(t)}}.bind(this),o)}catch(t){return o(t)}}.bind(this),o)}.bind(this))},j.prototype.last=function(){return new Promise(function(t,e){var n;return n=this.baseUrl+"couch_sku/last/000/?sessionId="+this.sessionId,console.log(n),fetch(n).then(function(n){try{return n.json().then(function(n){try{return t(n)}catch(t){return e(t)}}.bind(this),e)}catch(t){return e(t)}}.bind(this),e)}.bind(this))};var E,O,W,F=function(t){function e(){var e=this;t.call(this),this.wioService=new j(this.getQueryString("endpoint")),this.initFrame=o(M,{wioService:this.wioService,next:function(){return e.show(e.nextFrame)}}),this.nextFrame=o(B,{wioService:this.wioService,next:function(){return e.show(e.lastFrame)}}),this.lastFrame=o(T,{wioService:this.wioService}),this.state={currentComponent:this.initFrame}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getQueryString=function(t,e){var n=e||window.location.href,o=new RegExp("[?&]"+t+"=([^&#]*)","i").exec(n);return o?o[1]:null},e.prototype.show=function(t){this.setState({currentComponent:t})},e.prototype.render=function(){var t=this.state.currentComponent;return o("div",null,o("h2",null,"Démo canapés"),t)},e}(I);E=o(F,null),O=document.getElementById("root"),x(W,E,{},!1,O,!1);
//# sourceMappingURL=bundle.m.js.map
